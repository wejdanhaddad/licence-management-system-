{% extends 'base.html.twig' %}

{% block title %}Produits par Cat√©gorie{% endblock %}

{% block body %}
<div class="container my-5 p-4" style="background: linear-gradient(to bottom right, #f0f4f8, #ffffff); border-radius: 20px; box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08); font-family: 'Nunito', sans-serif;">
    <!-- üå∏ Titre principal -->
    <h1 class="mb-5 text-center fw-bold" style="color: #6a8caf; font-size: 2.6rem;">Rechercher un Produit sous Licence</h1>

    <div class="row align-items-center mb-5">
        <!-- üå∏ Image -->
        <div class="col-md-6 text-center mb-4 mb-md-0">
            <img src="{{ asset('uploads/service.png') }}" alt="Recherche" class="img-fluid rounded" style="max-height: 250px;">
        </div>

        <!-- üå∏ Formulaire -->
        <div class="col-md-6">
            <div class="card p-4 border-0 shadow-sm" style="border-radius: 16px; background-color: #ffffff;">
                {{ form_start(form) }}
                <div class="row g-3 align-items-end">
                    <div class="col-md-8">
                        {{ form_row(form.category, {
                            'attr': {
                                'class': 'form-control shadow-sm',
                                'style': 'border-radius: 10px; border: 1px solid #aac4d7; padding: 12px;',
                                'required': 'required'
                            }
                        }) }}
                    </div>
                    <div class="col-md-4">
                        <button type="submit" class="btn w-100 py-2"
                                style="background-color: #6a8caf; color: white; font-weight: 600; border-radius: 10px;">
                            Rechercher
                        </button>
                    </div>
                </div>
                {{ form_end(form, {'render_rest': false}) }}
            </div>
        </div>
    </div>

    <!-- üå∏ R√©sultats -->
    {% if produits is not empty %}
        <div class="table-responsive">
            <table id="produits" class="table table-hover text-center align-middle">
                <thead style="background-color: #aac4d7; color: white;">
                    <tr>
                        <th>Produit</th>
                        <th>Cat√©gorie</th>
                        <th>Prix</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for produit in produits %}
                        <tr style="transition: all 0.3s;">
                            <td style="font-weight: 600;">{{ produit.name }}</td>
                            <td>{{ produit.category.name|default('Non class√©') }}</td>
                            <td>{{ produit.prix|number_format(2, ',', ' ') }} DT</td>
                            <td>
                                <a href="{{ path('produit_details', {'id': produit.id}) }}"
                                   class="btn btn-outline-primary btn-sm"
                                   style="border-radius: 8px; border-color: #6a8caf; color: #6a8caf;">
                                    D√©tails
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="alert alert-warning text-center mt-4" style="background-color: #fff3cd; color: #856404; border-radius: 10px;">
            Aucun produit trouv√© dans cette cat√©gorie.
        </div>
    {% endif %}
</div>

<!-- üå∏ Style + Animations -->
<style>
    body {
        background-color: #f5f7fa;
    }
    table tbody tr:hover {
        background-color: rgba(106, 140, 175, 0.08);
        transform: scale(1.01);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.03);
    }

    .btn:hover {
        transform: scale(1.05);
        background-color: #5a7c99 !important;
        color: white !important;
        transition: all 0.3s ease;
    }

    .card:hover {
        transform: translateY(-5px);
        transition: transform 0.3s ease-in-out;
    }

    h1, th {
        font-family: 'Nunito', sans-serif;
    }
</style>
{% endblock %}
